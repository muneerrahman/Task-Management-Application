{% extends "tasks/base.html" %}
{% block content %}
<h2>All Users</h2>
<a href="{% url 'superadmin_create_user' %}">Create User</a>

<table border="1">
<tr>
    <th>Username</th>
    <th>Role</th>
    <th>Admin Assigned</th>
    <th>Actions</th>
</tr>
{% for user in users %}
<tr>
    <td>{{ user.username }}</td>
    <td>{{ user.role }}</td>
    <td>
        <!-- Assign Admin form -->
        <form method="POST" action="{% url 'superadmin_assign_user' %}">
            {% csrf_token %}
            <input type="hidden" name="user_id" value="{{ user.id }}">
            <select name="admin_id" onchange="this.form.submit()">
                <option value="">None</option>
                {% for admin in admins %}
                    <option value="{{ admin.id }}" {% if user.admin and user.admin.id == admin.id %}selected{% endif %}>
                        {{ admin.username }}
                    </option>
                {% endfor %}
            </select>
        </form>
    </td>
    <td>
        <!-- Delete User form -->
        <form method="POST" action="{% url 'superadmin_delete_user' user.id %}" style="display:inline;">
            {% csrf_token %}
            <button type="submit" style="color:red;" onclick="return confirm('Are you sure you want to delete this user?')">Delete</button>
        </form>
    </td>
</tr>
{% endfor %}
</table>
{% endblock %}
